{% extends 'base.njk' %}

{% block body_class %}home{% endblock %}

{% block content %}

	<main class="home">

		{% for post in collections.post | removeHiddenPostsAndPages | reverse %}
		
		<a href="/{{ post.data.slug }}/" class="card" style="width: {{ post.data | card_width }}px;">
			
			<div class="content">
				<h1>{{ post.data.title }}</h1>
				
				<div class="description">
					{{ post.data.description | safe }}
				</div>

				<div class="metadata">
					{{ post.data.authors | homepage_authors | safe }}&nbsp;&bull;&nbsp;{{ post.data.date | readable_date | safe }}
				</div>
				
				{% if post.data.flag %}
					<div class="flag">{{ post.data.flag }}</div>
				{% endif %}
			</div>

		</a>

		{% endfor %}

	</main>

	<script>
		if (window.netlifyIdentity) {
			window.netlifyIdentity.on("init", user => {
				if (!user) {
					window.netlifyIdentity.on("login", () => {
						document.location.href = "/admin/";
					});
				}
			});
		}
	</script>

{% endblock %}